SELECT F.ID,
	F.TITLE,
	F.DESCRIPTION,
	F.UPVOTES,
	S.NAME AS STATUSNAME,
	CT.NAME AS CATEGORYNAME,
	COALESCE(COUNT(RPCM.ID),
		0) AS COMMENTCOUNT,
	COALESCE(SUM(RPCM.RS),
		0) AS REPLIESCOUNT
FROM FEEDBACKS F
LEFT JOIN STATUS S ON F.STATUS = S.ID
LEFT JOIN CATEGORIES CT ON F.CATEGORY = CT.ID
LEFT JOIN
	(SELECT CM.ID,
			"cm"."parentFeedback",
			COUNT(RP.ID) AS RS
		FROM COMMENTS CM
		LEFT JOIN REPLIES RP ON "rp"."parentComment" = CM.ID
		GROUP BY CM.ID) RPCM ON "rpcm"."parentFeedback" = F.ID
GROUP BY F.ID,
	S.ID,
	CT.ID;

-- SELECT CM.ID,
-- 	STRING_AGG(RP.ID::varchar,
 -- 		',') AS REPLIES
-- FROM COMMENTS CM
-- LEFT JOIN REPLIES RP ON "rp"."parentComment" = CM.ID
-- GROUP BY CM.ID;